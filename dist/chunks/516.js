"use strict";(globalThis.webpackChunkwp_travel_engine=globalThis.webpackChunkwp_travel_engine||[]).push([[516],{1997:(e,t,a)=>{a.d(t,{ButtonGroup:()=>C,Counter:()=>b,Icon:()=>k,PricingItem:()=>N,PricingTable:()=>P,Select:()=>L,Tooltip:()=>x});var n=a(1609);const r=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"2",viewBox:"0 0 14 2"},(0,n.createElement)("path",{"data-name":"Path 23951",d:"M0,0H12",transform:"translate(1 1)",fill:"none",stroke:"#170d44",strokeLinecap:"round",strokeWidth:"2",opacity:"0.5"})),l=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14"},(0,n.createElement)("g",{"data-name":"Group 2263",transform:"translate(-78 -14)",opacity:"0.5"},(0,n.createElement)("line",{"data-name":"Line 2",x2:"12",transform:"translate(79 21)",fill:"none",stroke:"#170d44",strokeLinecap:"round",strokeWidth:"2"}),(0,n.createElement)("line",{"data-name":"Line 3",x2:"12",transform:"translate(84.999 15) rotate(90)",fill:"none",stroke:"#170d44",strokeLinecap:"round",strokeWidth:"2"}))),i=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"14",viewBox:"0 0 13 14"},(0,n.createElement)("g",{id:"Group_2371","data-name":"Group 2371",transform:"translate(0)"},(0,n.createElement)("rect",{id:"Rectangle_1682","data-name":"Rectangle 1682",width:"13",height:"3",transform:"translate(0)",fill:"#170d44",opacity:"0.6"}),(0,n.createElement)("g",{id:"Rectangle_1683","data-name":"Rectangle 1683",transform:"translate(0 3)",fill:"none",strokeWidth:"1",opacity:"0.6"},(0,n.createElement)("rect",{width:"13",height:"11",stroke:"none"}),(0,n.createElement)("rect",{x:"0.5",y:"0.5",width:"12",height:"10",fill:"none"})))),s=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"14.812",viewBox:"0 0 10 14.812"},(0,n.createElement)("g",{id:"Group_2254","data-name":"Group 2254",transform:"translate(-1072.099 -77)"},(0,n.createElement)("g",{id:"Group_2416","data-name":"Group 2416",transform:"translate(1072.099 77)"},(0,n.createElement)("path",{id:"Path_23953","data-name":"Path 23953",d:"M33.115,6.1h-1.6V4.317a1.055,1.055,0,0,0-1.158-.9h-2.02a1.055,1.055,0,0,0-1.158.9V6.1h-1.6a1.121,1.121,0,0,0-1.232.958v9.236a1.1211.121,0,0,0,1.232.958h.628v.594a.448.448,0,0,0,.492.383h.32a.448.448,0,0,0,.493-.383v-.594h3.67v.594a.448.448,0,0,0,.493.383h.32a.448.448,0,0,0,.493-.383v-.594h.628a1.121,1.121,00,0,1.232-.958V7.057A1.12,1.12,0,0,0,33.115,6.1Zm-5.1-1.782a.292.292,0,0,1,.32-.249h2.02a.292.292,0,0,1,.32.249V6.1h-2.66Z",transform:"translate(-24.346 -3.416)"})))),o=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"4",viewBox:"0 0 16 4"},(0,n.createElement)("g",{id:"Group_2257","data-name":"Group 2257",transform:"translate(-349.914 -82)"},(0,n.createElement)("g",{id:"Group_2418","data-name":"Group 2418"},(0,n.createElement)("circle",{id:"Ellipse_100","data-name":"Ellipse 100",cx:"2",cy:"2",r:"2",transform:"translate(349.914 82)"}),(0,n.createElement)("circle",{id:"Ellipse_101","data-name":"Ellipse 101",cx:"2",cy:"2",r:"2",transform:"translate(355.914 82)"}),(0,n.createElement)("circle",{id:"Ellipse_102","data-name":"Ellipse 102",cx:"2",cy:"2",r:"2",transform:"translate(361.914 82)"})))),c=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"6",height:"8.226",viewBox:"0 0 6 8.226"},(0,n.createElement)("path",{id:"Path_23222","data-name":"Path 23222",d:"M361.369,288.944a1.569,1.569,0,0,0-1.026,1.453v.365h-1.014a4.251,4.251,0,0,1,.119-1.217,2.424,2.424,0,0,1,1.026-1.126c.9-.536,1.311-1.088,1.252-1.656-.089-.81-.611-1.238-1.56-1.292a1.956,1.956,0,0,0-2.1,1.656l-1.079-.466.178-.418c.492-1.147,1.554-1.7,3.179-1.656,1.607.08,2.485.783,2.633,2.1q.134,1.254-1.607,2.262Zm-1.014,3.865h-1.026v-1.034h1.026Z",transform:"translate(-356.985 -284.584)",fill:"#170d44"})),p=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5.81",height:"10.121",viewBox:"0 0 5.81 10.121"},(0,n.createElement)("path",{id:"Path_23963","data-name":"Path 23963",d:"M3290.465,368.331l4,4-4,4",transform:"translate(-3289.404 -367.271)",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",opacity:"0.8"})),m=(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5.811",height:"10.121",viewBox:"0 0 5.811 10.121"},(0,n.createElement)("path",{id:"Path_23952","data-name":"Path 23952",d:"M3294.464,368.331l-4,4,4,4",transform:"translate(-3289.714 -367.271)",fill:"none",stroke:"#147dfe",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})),d=(0,n.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M6 9L12 15L18 9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})),u=(0,n.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M18 15L12 9L6 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})),g=(0,n.createElement)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M14.125 6.66658H2.125M14.125 8.33325V5.86659C14.125 4.74648 14.125 4.18643 13.907 3.7586C13.7153 3.38228 13.4093 3.07632 13.033 2.88457C12.6052 2.66659 12.0451 2.66659 10.925 2.66659H5.325C4.2049 2.66659 3.64484 2.66659 3.21702 2.88457C2.84069 3.07632 2.53473 3.38228 2.34299 3.7586C2.125 4.18643 2.125 4.74648 2.125 5.86658V11.4666C2.125 12.5867 2.125 13.1467 2.34299 13.5746C2.53473 13.9509 2.84069 14.2569 3.21702 14.4486C3.64484 14.6666 4.2049 14.6666 5.325 14.6666H8.125M10.7917 1.33325V3.99992M5.45833 1.33325V3.99992M9.79167 12.6666L11.125 13.9999L14.125 10.9999",stroke:"currentColor",strokeWidth:"1.336",strokeLinecap:"round",strokeLinejoin:"round"})),v=(0,n.createElement)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M14.5416 4.85185L8.87498 8M8.87498 8L3.20831 4.85185M8.87498 8L8.875 14.3333M14.875 10.7057V5.29431C14.875 5.06588 14.875 4.95167 14.8413 4.8498C14.8116 4.75969 14.7629 4.67696 14.6986 4.60717C14.6259 4.52828 14.526 4.47281 14.3264 4.36188L9.39302 1.62114C9.20395 1.5161 9.10942 1.46358 9.0093 1.44299C8.9207 1.42477 8.82931 1.42477 8.7407 1.44299C8.64059 1.46358 8.54605 1.5161 8.35698 1.62114L3.42365 4.36188C3.22396 4.47281 3.12412 4.52828 3.05142 4.60717C2.98711 4.67697 2.93843 4.75969 2.90866 4.84981C2.875 4.95167 2.875 5.06588 2.875 5.29431V10.7057C2.875 10.9341 2.875 11.0484 2.90866 11.1502C2.93843 11.2403 2.98711 11.3231 3.05142 11.3929C3.12412 11.4718 3.22397 11.5272 3.42365 11.6382L8.35698 14.3789C8.54605 14.4839 8.64059 14.5365 8.7407 14.557C8.82931 14.5753 8.9207 14.5753 9.0093 14.557C9.10942 14.5365 9.20395 14.4839 9.39302 14.3789L14.3264 11.6382C14.526 11.5272 14.6259 11.4718 14.6986 11.3929C14.7629 11.3231 14.8116 11.2403 14.8413 11.1502C14.875 11.0484 14.875 10.9341 14.875 10.7057Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.createElement)("path",{d:"M11.875 6.33333L5.875 3",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"})),h=(0,n.createElement)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M5.975 2H3.44167C3.0683 2 2.88161 2 2.73901 2.07266C2.61356 2.13658 2.51158 2.23856 2.44766 2.36401C2.375 2.50661 2.375 2.6933 2.375 3.06667V5.6C2.375 5.97337 2.375 6.16005 2.44766 6.30266C2.51158 6.4281 2.61356 6.53009 2.73901 6.594C2.88161 6.66667 3.0683 6.66667 3.44167 6.66667H5.975C6.34837 6.66667 6.53505 6.66667 6.67766 6.594C6.8031 6.53009 6.90509 6.4281 6.969 6.30266C7.04167 6.16005 7.04167 5.97337 7.04167 5.6V3.06667C7.04167 2.6933 7.04167 2.50661 6.969 2.36401C6.90509 2.23856 6.8031 2.13658 6.67766 2.07266C6.53505 2 6.34837 2 5.975 2Z",stroke:"currentColor",strokeWidth:"1.336",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.createElement)("path",{d:"M13.3083 2H10.775C10.4016 2 10.2149 2 10.0723 2.07266C9.9469 2.13658 9.84491 2.23856 9.781 2.36401C9.70833 2.50661 9.70833 2.6933 9.70833 3.06667V5.6C9.70833 5.97337 9.70833 6.16005 9.781 6.30266C9.84491 6.4281 9.9469 6.53009 10.0723 6.594C10.2149 6.66667 10.4016 6.66667 10.775 6.66667H13.3083C13.6817 6.66667 13.8684 6.66667 14.011 6.594C14.1364 6.53009 14.2384 6.4281 14.3023 6.30266C14.375 6.16005 14.375 5.97337 14.375 5.6V3.06667C14.375 2.6933 14.375 2.50661 14.3023 2.36401C14.2384 2.23856 14.1364 2.13658 14.011 2.07266C13.8684 2 13.6817 2 13.3083 2Z",stroke:"currentColor",strokeWidth:"1.336",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.createElement)("path",{d:"M13.3083 9.33333H10.775C10.4016 9.33333 10.2149 9.33333 10.0723 9.406C9.9469 9.46991 9.84491 9.5719 9.781 9.69734C9.70833 9.83995 9.70833 10.0266 9.70833 10.4V12.9333C9.70833 13.3067 9.70833 13.4934 9.781 13.636C9.84491 13.7614 9.9469 13.8634 10.0723 13.9273C10.2149 14 10.4016 14 10.775 14H13.3083C13.6817 14 13.8684 14 14.011 13.9273C14.1364 13.8634 14.2384 13.7614 14.3023 13.636C14.375 13.4934 14.375 13.3067 14.375 12.9333V10.4C14.375 10.0266 14.375 9.83995 14.3023 9.69734C14.2384 9.5719 14.1364 9.46991 14.011 9.406C13.8684 9.33333 13.6817 9.33333 13.3083 9.33333Z",stroke:"currentColor",strokeWidth:"1.336",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.createElement)("path",{d:"M5.975 9.33333H3.44167C3.0683 9.33333 2.88161 9.33333 2.73901 9.406C2.61356 9.46991 2.51158 9.5719 2.44766 9.69734C2.375 9.83995 2.375 10.0266 2.375 10.4V12.9333C2.375 13.3067 2.375 13.4934 2.44766 13.636C2.51158 13.7614 2.61356 13.8634 2.73901 13.9273C2.88161 14 3.0683 14 3.44167 14H5.975C6.34837 14 6.53505 14 6.67766 13.9273C6.8031 13.8634 6.90509 13.7614 6.969 13.636C7.04167 13.4934 7.04167 13.3067 7.04167 12.9333V10.4C7.04167 10.0266 7.04167 9.83995 6.969 9.69734C6.90509 9.5719 6.8031 9.46991 6.67766 9.406C6.53505 9.33333 6.34837 9.33333 5.975 9.33333Z",stroke:"currentColor",strokeWidth:"1.336",strokeLinecap:"round",strokeLinejoin:"round"})),w=(0,n.createElement)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M14.7913 11.3334V9.33341M14.7913 9.33341H1.45801M14.7913 9.33341H8.12467V6.00008H12.7913C13.3218 6.00008 13.8305 6.21079 14.2056 6.58587C14.5806 6.96094 14.7913 7.46965 14.7913 8.00008V9.33341ZM1.45801 5.33341V11.3334M3.45801 6.00008C3.45801 6.3537 3.59848 6.69284 3.84853 6.94289C4.09858 7.19294 4.43772 7.33341 4.79134 7.33341C5.14496 7.33341 5.4841 7.19294 5.73415 6.94289C5.9842 6.69284 6.12467 6.3537 6.12467 6.00008C6.12467 5.64646 5.9842 5.30732 5.73415 5.05727C5.4841 4.80722 5.14496 4.66675 4.79134 4.66675C4.43772 4.66675 4.09858 4.80722 3.84853 5.05727C3.59848 5.30732 3.45801 5.64646 3.45801 6.00008Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"})),E={minus:r,plus:l,calendar:i,suitcase:s,dots:o,help:c,"angle-right":p,"angle-left":m,"angle-down":d,"angle-up":u,calendarCheck:g,packageIcon:v,grid:h,bed:w},k=({icon:e})=>E[e],f=({onClick:e,type:t="button",label:a,className:r="",disabled:l=!1})=>"string"==typeof a?(0,n.createElement)("button",{dangerouslySetInnerHTML:{__html:a},type:t,onClick:e,className:r,disabled:l}):(0,n.createElement)("button",{type:t,onClick:e,className:r,disabled:l},a),b=({value:e,onChange:t,min:a=-1/0,max:i=1/0})=>(0,n.createElement)("div",{className:"wte-qty-number wte-booking-pc-counter","data-info":'{"packageID":6052,"catID":15}'},(0,n.createElement)(f,{className:"prev wte-down",disabled:e-1<a,onClick:()=>t(e-1),label:r}),(0,n.createElement)("input",{type:"text",value:e,readOnly:!0}),(0,n.createElement)(f,{className:"next wte-up",disabled:e+1>i,onClick:()=>t(e+1),label:l}));var y=a(6087),T=a(7723);const C=({options:e,checked:t,onChange:a,isShowMore:r=!1})=>{const[l,i]=(0,y.useState)(!1),s=!l&&r?e.slice(0,3):e;return(0,n.createElement)("div",{className:"wte-button-group",role:"group","aria-label":"Toggle Button Group"},s.map((({label:e,value:r})=>(0,n.createElement)("div",{key:r},(0,n.createElement)("input",{type:"radio",name,id:`btn_radio_${r}`,style:{position:"absolute",clip:"rect(0, 0, 0, 0)",pointerEvents:"none"},autoComplete:"off",checked:r===t,onChange:()=>a(r)}),(0,n.createElement)("label",{className:"wte-check-button"+(r===t?" checked":""),htmlFor:`btn_radio_${r}`,dangerouslySetInnerHTML:{__html:e}})))),r&&e.length>3&&(0,n.createElement)("button",{type:"butotn",className:"wte-check-button",onClick:()=>i(!l),style:{paddingLeft:"20px",paddingRight:"20px"}},l?(0,T.__)("Show Less","wp-travel-engine"):(0,T.__)("Show More","wp-travel-engine"),(0,n.createElement)(k,{icon:l?"angle-up":"angle-down"})))};var _=a(1504);const x=({content:e,children:t,...a})=>(0,n.createElement)(_.Ay,{interactive:!0,content:e,...a},t);var S=a(6814);const L=({value:e,options:t,onChange:a})=>(0,n.createElement)("div",{className:"wpte-select-options"},(0,n.createElement)("select",{className:"option-toggle",value:e,onChange:e=>a(e.target.value)},t?.map((({value:e,label:t},a)=>(0,n.createElement)("option",{key:e,value:e},t))))),N=e=>{const{direction:t="horizontal",required:a=!1,label:r,helpText:l,hasSale:i,actualPrice:s,price:o,ageGroup:c,perTextLabel:p,perTextDescription:m,counter:d,afterLabel:u="",html:g}=e;return""===o?null:(0,n.createElement)("div",{className:`wte-trip-guest-wrapper ${t}`},(0,n.createElement)("div",{className:"check-in-wrapper"},(0,n.createElement)("label",{dangerouslySetInnerHTML:{__html:`${r}${c&&` (${c}) `||""}${a?'<span class="wte-required" style="color:red">&nbsp;*</span>':""}`}}),l&&(0,n.createElement)(x,{content:(0,n.createElement)("div",{dangerouslySetInnerHTML:{__html:l}})},(0,n.createElement)("span",{className:"wte-meta-help"},(0,n.createElement)(k,{icon:"help"}))),u),(0,n.createElement)("div",{className:"select-wrapper"},(0,n.createElement)("div",{className:"amount-per-person"},i&&s>=o&&(0,n.createElement)("span",{className:"regular-price"},(0,n.createElement)("del",null,(0,n.createElement)(S.A,{value:s}))),(0,n.createElement)("span",{className:"offer-price"},(0,n.createElement)(S.A,{value:o})),(0,n.createElement)("span",{className:"per-text-wrapper"},p&&(0,n.createElement)("span",{className:"per-text"},p),m&&(0,n.createElement)(x,{content:(0,n.createElement)("div",{dangerouslySetInnerHTML:{__html:m}})},(0,n.createElement)("span",{className:"wte-meta-help"},(0,n.createElement)(k,{icon:"help"}))))),d&&(0,n.createElement)(b,{value:d?.value,min:d?.min,max:d?.max,onChange:d?.onChange}),g))},P=({children:e,heading:t})=>(0,n.createElement)(n.Fragment,null,t&&(0,n.createElement)("div",{className:"wte-option-heading"},t," "),(0,n.createElement)("div",{className:"wte-trip-options"},e()))},6814:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(1609);const{priceFormat:r}=wteL10n,l=({prefix:e,suffix:t,value:a,noHTML:l=!1,convert:i=!0})=>(0,n.createElement)("span",{dangerouslySetInnerHTML:{__html:`${e||""}${r(a).format(l,i)}${t||""}`}})},8516:(e,t,a)=>{a.r(t),a.d(t,{bookingModalContext:()=>Z,useBookingModalContext:()=>Y});var n=a(1609),r=a(6087),l=a(7143),i=a(2619),s=a(7723);const o=({isOpen:e,setIsOpen:t,children:a})=>{const l=(0,r.useRef)(null),i=(0,r.useRef)(null);(0,r.useEffect)((()=>{e&&(document.body.style.overflow="hidden",i.current.classList.add("showing"),setTimeout((()=>{i.current.classList.remove("showing")}),300))}),[e]);const s=()=>{document.body.style.overflow="",i.current.classList.add("hiding"),setTimeout((()=>{t(!1)}),300)};return(0,n.createElement)(n.Fragment,null,e&&(0,r.createPortal)((0,n.createElement)("div",{ref:i,className:"wpte-modal__screen-overlay",onClick:e=>{l.current.contains(e.target)||s()}},(0,n.createElement)("div",{ref:l,className:"wpte-modal"},(0,n.createElement)("button",{type:"button",role:"close-button",className:"wpte-modal__close-button",onClick:()=>s()},(0,n.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":"true",focusable:"false"},(0,n.createElement)("path",{d:"M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"}))),a)),document.body))};var c=a(8193),p=a(8468),m=a.n(p),d=a(6154),u=a.n(d),g=a(1997);const{locale:v}=wteL10n,h=({options:e})=>{const{state:{tripID:t}}=Y(),a=(0,l.useSelect)((e=>e("wptravelengine").getTripDates(t)),[t]),s=(0,r.useRef)(null),o=(0,r.useRef)(null),c=(0,r.useCallback)((()=>{var t,n;o.current&&o.current.destroy(),o.current=flatpickr(s.current,(0,i.applyFilters)("wptravelengine.flatpickr.options",e,a)),flatpickr.localize(null!==(t=flatpickr?.l10ns?.[null!==(n=v.split("_")[0])&&void 0!==n?n:"en"])&&void 0!==t?t:"en")}),[e]);return(0,r.useEffect)((()=>(c(),()=>{o.current&&o.current.destroy()})),[c]),(0,n.createElement)("div",{ref:s})},w=({onDateChange:e,onTimeChange:t})=>{var a,i;const{state:s,setState:o}=Y(),{tripID:p,availableTimes:d,summary:v,summary:{selectedTripDate:w,selectedTimeSlot:E}}=s,k=(0,l.useSelect)((e=>e("wptravelengine").getTripDates(p)),[p]),f=(0,r.useMemo)((()=>k.reduce(((e,{dates:t={}})=>(Object.entries(t).forEach((([t,a])=>{var n,r;const l=null!==(n=e[t]?.seats)&&void 0!==n?n:0,i=null!==(r=a?.seats)&&void 0!==r?r:0;e[t]={...a,seats:[l,i].includes("")?"":l+i}})),e)),{})),[k]);(0,r.useEffect)((()=>{m().isEmpty(f)||o({isLoading:!1})}),[f]);const b=(e=>{const t=Object.keys(e).sort(),a=t.findIndex((t=>0!==e[t].seats));return-1!==a?t[a]:t[0]})(f);(0,r.useEffect)((()=>{setTimeout((()=>{!w&&e(b)}),100)}),[b]);const y=null!==(a=k?.filter((({dates:e})=>!!e[w])))&&void 0!==a?a:[];return(0,n.createElement)("div",{className:"wte-process-tab-content-wrapper"},(0,n.createElement)("div",{id:"wte-booking-datetime-content"},(0,n.createElement)("div",{className:"wte-process-tab-content"},(0,n.createElement)("div",{className:"wte-booking-date-wrap"},(0,n.createElement)(h,{options:{inline:!0,defaultDate:null!==(i=v.selectedTripDate)&&void 0!==i?i:b,minDate:b,dateFormat:"Y-m-d",onChange:(t,a)=>e(a),disable:[function(e){var t;const a=null!==(t=f[u()(e).format("YYYY-MM-DD")]?.seats)&&void 0!==t?t:-1;return(0,c.Et)(a)&&a<=0||!1}]}}),d.length>0&&(0,n.createElement)("div",null,(0,n.createElement)("div",{className:"wte-booking-times"},y.map((({package:e},a)=>{const{id:l,name:i}=e,s=d.filter((({package_id:e})=>l===e));return s.length<=0?null:(0,n.createElement)(r.Fragment,{key:a},y.length>1&&i&&(0,n.createElement)("span",{className:"wte-package-name",dangerouslySetInnerHTML:{__html:i}}),(0,n.createElement)(g.ButtonGroup,{options:s.map((({from:e,to:t,key:a})=>({label:`${u()(e).format("h:mm A")} - ${u()(t).format("h:mm A")}`,value:a}))),checked:E,onChange:t,isShowMore:!0}))}))))))))},E=({item:e,onChange:t})=>{var a;const[l,i]=(0,r.useState)(e.options[0].key),{state:{summary:{extraServices:s}}}=Y(),{title:o,options:c,required:m,multiple:d}=e,u={required:m},v=(0,p.keyBy)(s,"id");if(d&&c.length>1)return c.map(((e,a)=>{var r;const{price:l,label:i,key:s}=e;return(0,n.createElement)(g.PricingItem,{key:s,label:i,price:l,direction:"vertical",perTextLabel:`/ ${e.serviceUnit.label}`,helpText:e.description,counter:{min:0,max:1/0,value:null!==(r=v[s]?.qty)&&void 0!==r?r:0,onChange:a=>t(e,a)}})}));const h=!d&&c.length>1?(0,n.createElement)(g.Select,{options:c.map((({label:e,key:t},a)=>({value:t,label:e}))),value:l,onChange:e=>{i(e),t({key:e,price:0},0)}}):null,w=c.find((({key:e})=>e===l));return(0,n.createElement)(g.PricingItem,{...u,perTextLabel:`/ ${c.find((({key:e})=>e===l)).serviceUnit.label}`,price:w.price,afterLabel:h,label:o,helpText:w.description,counter:{min:0,max:1/0,value:null!==(a=v[w.key]?.qty)&&void 0!==a?a:0,onChange:e=>t(w,e)}})},k=()=>{const{state:e,setState:t}=Y(),{tripID:a,summary:{extraServices:i}}=e,o=(0,l.useSelect)((e=>e("wptravelengine").getTripServices(a)),[a]);(0,r.useEffect)((()=>{o&&t({isLoading:!1})}),[o,e.currentTab]),(0,r.useEffect)((()=>{t({processToNext:i.filter((({required:e})=>e)).every((({qty:e})=>e>0))})}),[]);const c=a=>({key:n,price:r,label:l},s)=>{const{required:o,options:c,multiple:p}=a,m=parseFloat(r)*s;let d=i;l||(d=d.filter((({id:e})=>!a.options.some((({key:t})=>t===e))))),d.forEach((({id:e},t)=>{c.find((({key:t})=>t===e))&&o&&(d[t].required=e===n,p&&(d[t].required=e===n?c.filter((({key:t})=>t!==e)).every((({key:e})=>0===d.find((({id:t})=>t===e)).qty)):d[t].qty>0))}));const u=d.findIndex((({id:e})=>e===n));if(-1!==u)d[u]={...d[u],qty:s,total:m};else{const{price:e,serviceUnit:t,label:a}=c.find((({key:e})=>e===n));d=[...d,{id:n,label:a,unitPrice:e,qty:s,total:m,perTextLabel:` / ${t.label}`,required:o}]}t({processToNext:d.filter((({required:e})=>e)).every((({qty:e})=>e>0)),summary:{...e.summary,extraServices:d}})};return(0,n.createElement)("div",{className:"wte-process-tab-content-wrapper"},(0,n.createElement)("h5",{className:"wte-process-tab-title"},(0,s.__)("Select Extra Services: ","wp-travel-engine")),(0,n.createElement)(g.PricingTable,null,(()=>o.map((e=>{return(t=E,({service:e,...a})=>{const{multiple:r,options:l,id:i,title:s,required:o}=e;return r&&l.length>1?(0,n.createElement)("div",{className:"wte-trip-options",key:i},(0,n.createElement)("h5",{className:"wte-process-tab-title"},(0,n.createElement)("span",{dangerouslySetInnerHTML:{__html:s}}),o&&(0,n.createElement)("span",{className:"wte-required",style:{color:"red"}}," *")),(0,n.createElement)("div",{className:"wte-es-with-multiple-options wte-owl-carousel"},(0,n.createElement)(t,{item:e,...a}))):(0,n.createElement)(t,{item:e,...a,key:i})})({service:e,onChange:c(e)});var t})))))};var f=a(1504),b=a(6814);const y=({options:e,onChange:t,selected:a})=>(0,n.createElement)(g.ButtonGroup,{options:e,onChange:t,checked:a}),T=({discountList:e,perTextLabel:t})=>(0,n.createElement)(f.Ay,{interactive:!0,theme:"light",placement:"bottom",trigger:"click",className:"wpte-select-options-wrapper wpte-group-discount-options",content:(0,n.createElement)("ul",{className:"options-list"},(0,n.createElement)("li",{className:"list-heading"},(0,n.createElement)("span",{className:"no-travelers"},(0,s.__)("Number Of Travellers","wp-travel-engine")),(0,n.createElement)("span",{className:"price-per-person"},(0,s.__)("Price","wp-travel-engine")," ",t)),e?.map((({from:e,to:t,price:a},r)=>(0,n.createElement)("li",{key:r},(0,n.createElement)("span",{className:"traveler-title"},`${e}${t?` - ${t}`:"+"}`),(0,n.createElement)("span",{className:"traveler-price"},(0,n.createElement)(b.A,{value:a}))))))},(0,n.createElement)("div",{className:"wpte-select-options wpte-group-discount-options wte-popper active"},(0,n.createElement)("button",{type:"buttton",className:"option-toggle"},(0,s.__)("Group Discount","wp-travel-engine")))),C=({items:e,pricing:t,onChange:a})=>{const{state:{summary:{travelers:r}},availableSeats:l}=Y(),i=(0,p.keyBy)(r,"id");return e.map((({id:e,price:s,sale_price:o,has_sale:c,min_pax:m,max_pax:d,age_group:u,group_pricing:v,has_group_pricing:h,pricing_type:w,label:E})=>{var k;let f=c?o:s;const{price:b=f,group_pricing:y=v}=t.find((t=>t.id===e))||{},C=(0,p.isNumber)(l)?l-r.filter((t=>t.id!==e)).reduce(((e,{qty:t})=>e+t),0):1/0,_=Math.max(null!==(k=i?.[e]?.qty)&&void 0!==k?k:m,m),x=`/ ${w.label}`,S=w?.description;var L;return f=h?null!==(L=y?.find((({from:e,to:t})=>_>=e&&(!t||_<=t)))?.price)&&void 0!==L?L:b:""!==b?b:f,(0,n.createElement)(g.PricingItem,{key:e,label:E,price:f,ageGroup:u,hasSale:c,actualPrice:s,perTextLabel:x,perTextDescription:S,counter:{min:m,max:(0,p.isNumber)(C)||(0,p.isNumber)(d)?parseInt(d)<C?d:C:1/0,value:_,onChange:t=>a(e,t)},afterLabel:h&&(0,n.createElement)(T,{discountList:y,perTextLabel:x})})}))},_=()=>(0,n.createElement)(n.Fragment,null,(0,n.createElement)("span",{className:"text-left"},(0,s.__)("Travellers","wp-travel-engine")),(0,n.createElement)("span",{className:"text-right"},(0,s.__)("Quantity","wp-travel-engine"))),x=({onChange:e,onTravelerChange:t})=>{const a=Y(),{state:{tripID:o,availableTripPackages:c,summary:p,currentTab:m},setState:d,availableSeats:u}=a,{selectedTripPackageID:v,travelers:h,selectedTripDate:w}=p;(0,r.useEffect)((()=>{if(h?.length>0){const e=h.reduce(((e,{qty:t})=>e+t),0);d({isLoading:!1,processToNext:e>=Math.max(f.min_pax,1)})}}),[h,m]);const E=(0,l.useSelect)((e=>e("wptravelengine").getTripDates(o)),[o]),k=(0,l.useSelect)((e=>e("wptravelengine").getTripPackages(o)),[o]);if(0===k.length)return null;const f=k.find((({id:e})=>e===v)),b=E.find((({package:{id:e}})=>e===v))?.dates[w]?.pricing||[],T=f?.traveler_categories||[],x=u>0||""===u;return(0,n.createElement)("div",{className:"wte-process-tab-content-wrapper"},(0,n.createElement)("div",null,(0,n.createElement)("div",{className:"wte-process-tab-content"},(0,i.applyFilters)("wptravelengine.tripBookingModal.beforePackages",!1,{availableTripPackages:c,tripPackages:k,selectedTripPackageID:v}),c.length>1&&(0,n.createElement)("div",{className:"wte-button-group wte-package-type"},(0,n.createElement)(y,{options:c.map((e=>{const{name:t}=k.find((({id:t})=>t===e));return{label:t,value:e}})),selected:v,onChange:e})),f?.description&&(0,n.createElement)("div",{className:"wte-selected-package-description",dangerouslySetInnerHTML:{__html:f.description}}),(0,n.createElement)("hr",null),x?(0,n.createElement)(g.PricingTable,{heading:(0,n.createElement)(_,null)},(()=>(0,n.createElement)(C,{items:T,pricing:b,onChange:t}))):(0,n.createElement)("div",{className:"failed-msg"},(0,s.__)("Seats are not available for selected package","wp-travel-engine")))))};var S=a(1455),L=a.n(S);const N={trips:{},isLoading:!0},P={setTrip:e=>({type:"SET_TRIP",data:e}),setTripDates:(e,t)=>({type:"SET_TRIP_DATES",id:t,data:e}),setTripServices:(e,t)=>({type:"SET_TRIP_SERVICES",id:t,data:e}),setTripPackages:(e,t)=>({type:"SET_TRIP_PACKAGES",id:t,data:e}),fetchFromAPI:e=>({type:"FETCH_FROM_API",path:e}),fetchTripData:(e,t="")=>({type:"FETCH_TRIP_DATA",id:e,path:t})},D={getState:e=>e,getTrip(e,t){var a;return null!==(a=e.trips?.[t]?.trip)&&void 0!==a?a:{}},getTripDates(e,t){var a;return null!==(a=e.trips?.[t]?.dates)&&void 0!==a?a:[]},getTripServices(e,t){var a;return null!==(a=e.trips?.[t]?.services)&&void 0!==a?a:[]},getTripPackages(e,t){var a;return null!==(a=e.trips?.[t]?.packages)&&void 0!==a?a:[]},isLoading:e=>e.isLoading},I={FETCH_FROM_API:e=>L()({path:e.path}),FETCH_TRIP_DATA({id:e,path:t}){const{wpApiSettings:{root:a},wteL10n:{locale:n}}=window;return L()({url:`${a}wptravelengine/v2/trips/${e}/${t}?lang=${n}`})}},M={*getTrip(e,t){const a=yield P.fetchTripData(e,t);return P.setTrip(a)},*getTripDates(e){const t=yield P.fetchTripData(e,"dates");return P.setTripDates(t,e)},*getTripServices(e){const t=yield P.fetchTripData(e,"services");return P.setTripServices(t,e)},*getTripPackages(e){const t=yield P.fetchTripData(e,"packages");return P.setTripPackages(t,e)}},q=(0,l.createReduxStore)("wptravelengine",{reducer:(e=N,t)=>{const{type:a}=t;switch(a){case"SET_TRIP":return{...e,isLoading:!1,trips:{...e.trips,[t.data.id]:{...e.trips[t.data.id],trip:t.data}}};case"SET_TRIP_DATES":return{...e,isLoading:!1,trips:{...e.trips,[t.id]:{...e.trips[t.id],dates:t.data}}};case"SET_TRIP_SERVICES":return{...e,isLoading:!1,trips:{...e.trips,[t.id]:{...e.trips[t.id],services:t.data}}};case"SET_TRIP_PACKAGES":return{...e,isLoading:!1,trips:{...e.trips,[t.id]:{...e.trips[t.id],packages:t.data}}};default:return e}},actions:P,selectors:D,controls:I,resolvers:M});function B(e){return(0,l.useSelect)((t=>t("wptravelengine").getTrip(e)),[e])}(0,l.register)(q);const R=({id:e,title:t,items:a=[]})=>a.length<1||a.every((e=>0===e.qty))?null:(0,n.createElement)("div",{className:`wte-booking-details ${e}`},(0,n.createElement)("h6",{className:"wte-booking-details-title"},t),(0,n.createElement)("ul",null,a?.map(((e,t)=>{const{label:a="",qty:l=null,total:i=null,unitPrice:s=null,perTextLabel:o="",childrens:c=[]}=e;return l<1?null:(0,n.createElement)(r.Fragment,{key:t},(0,n.createElement)("li",{className:"wte-booking-details-item"},(0,n.createElement)("label",null,(0,n.createElement)("span",{className:"qty",style:{fontWeight:c.length>0&&"500",color:c.length>0&&"#000"},dangerouslySetInnerHTML:{__html:`${a}: ${l} x `}}),(0,n.createElement)(b.A,{noHTML:!0,value:s})),(0,n.createElement)("div",{className:"amount-figure"},(0,n.createElement)("strong",null,(0,n.createElement)(b.A,{value:i})))),c?.map((({label:e="",qty:t,total:a,unitPrice:r},l)=>t<1?null:(0,n.createElement)("li",{key:l,className:"wte-booking-details-item-children"},(0,n.createElement)("label",null,(0,n.createElement)("span",{className:"qty"},"↳ ",e,": ",t," x ",(0,n.createElement)(b.A,{noHTML:!0,value:r}))),(0,n.createElement)("div",{className:"amount-figure"},(0,n.createElement)("strong",null,(0,n.createElement)(b.A,{value:a})))))))})))),$=()=>{const{state:{tripID:e,summary:t,availableTimes:a},getTotal:r}=Y(),{selectedTripDate:o,travelers:c,extraServices:p,selectedTripPackageID:m,selectedTimeSlot:d}=t,u=B(e),g=(0,l.useSelect)((t=>t("wptravelengine").getTripPackages(e)),[e]).find((e=>e.id===m)),v=new wteL10n.dateFormat(o),h=(0,i.applyFilters)("wptravelengine.tripBookingModal.bookingDetails",[{key:"travellers",title:(0,s.__)("Travellers","wp-travel-engine"),items:c},{key:"extraServices",title:wteL10n?.l10n?.extraServicesTitle||(0,s.__)("Extra Services","wp-travel-engine"),items:p}],t);return(0,n.createElement)("aside",{className:"wte-popup-sidebar"},(0,n.createElement)("div",{className:"wte-booking-summary"},(0,n.createElement)("div",{id:"wte-booking-summary"},(0,n.createElement)("h5",{className:"wte-booking-block-title"},(0,s.__)("Booking Summary","wp-travel-engine")),(0,n.createElement)("h2",{className:"wte-booking-trip-title",dangerouslySetInnerHTML:{__html:u?.title?.rendered||""}}),o&&(0,n.createElement)("div",{className:"wte-booking-dates"},(0,n.createElement)("p",{className:"wte-booking-starting-date"},(0,s.__)("Starting Date:","wp-travel-engine"),(0,n.createElement)("strong",null,v.format(),d&&` at ${moment(a.find((({key:e})=>e===d))?.from).format("h:mm A")}`))),(0,n.createElement)("div",{className:"wte-booking-summary-info"},g&&(0,n.createElement)("h5",{className:"wte-booking-summary-info-title",dangerouslySetInnerHTML:{__html:`${(0,s.__)("Package:","wp-travel-engine")} ${g.name}`}}),(0,n.createElement)("div",{className:"wte-booking-trip-info"},h.map((({title:e,items:t,key:a})=>(0,n.createElement)(R,{key:a,id:a,title:e,items:t})))),(0,n.createElement)("div",{className:"total-amount"},(0,n.createElement)("p",{className:"price"},(0,n.createElement)("span",{className:"total-text"},(0,s.__)("Total :","wp-travel-engine")),(0,n.createElement)(b.A,{value:(0,i.applyFilters)("wptravelengine.tripBookingModal.totalAmount",r(),t)})))))))},H=({tabs:e=[],onSubmit:t,processToNext:a})=>{const l=(0,r.useRef)(null),{isLoading:i,state:{availableTimes:o,currentTab:c,btnLoading:p,completedTabs:m},state:d,setState:u}=Y(),v=e.filter((e=>e?.enabled));return(0,r.useEffect)((()=>{o.length>0&&l.current.scrollTo({top:l.current.scrollHeight,left:0,behavior:"smooth"})}),[o]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)("nav",{className:"wte-process-nav"},(0,n.createElement)("div",{className:"wte-process-container"},(0,n.createElement)("ul",{className:"wte-process-nav-list"},v.map(((e,t)=>{const{id:r,title:l,icon:i}=e,s=c===t?"active":"",o=m?.includes(t)?"finish":"",p=m?.includes(t);return(0,n.createElement)("li",{key:t,id:r,className:`wte-process-nav-item ${s} ${o}`,style:{width:`calc(${100/v.length}% - 4px)`}},(0,n.createElement)("a",{href:"#",onClick:e=>{e.preventDefault(),a&&p&&u({...d,currentTab:t,completedTabs:[...m,!m.includes(t)&&c]})}},i&&(0,n.createElement)("span",{className:"wte-icon"},i),l))}))))),(0,n.createElement)("div",{className:"wte-process-tabs"},(0,n.createElement)("div",{className:"wte-process-container"},(0,n.createElement)("div",{ref:l,className:"wte-process-tab-item"+(i?" loading":""),style:{display:"block"}},!i&&v[c]?.component),(0,n.createElement)("div",{className:"wte-process-tab-controller"},0!==c&&(0,n.createElement)("button",{type:"button",className:"wte-process-btn wte-process-btn-prev",onClick:()=>{c>0&&u({...d,currentTab:c-1,isLoading:!0})}},(0,n.createElement)(g.Icon,{icon:"angle-left"}),(0,s.__)("Back","wp-travel-engine")),(0,n.createElement)("button",{type:"button",className:"wte-process-btn wte-process-btn-next "+(p?"btn-loading":""),onClick:e=>{a&&c<v.length-1&&u({...d,currentTab:c+1,isLoading:!0,completedTabs:[...m,!m.includes(c)&&c]}),a&&c===v.length-1&&t(e)},disabled:!a},v.length-1===c?(0,s.__)("Proceed To Checkout","wp-travel-engine"):(0,s.__)("Continue","wp-travel-engine"))))))},F={isOpen:!1,availableTripPackages:[],availableTimes:[],btnLoading:!1,processToNext:!1,isLoading:!0,currentTab:0,completedTabs:[],subtotalReservations:["travelers","extraServices"],summary:{selectedTripDate:null,selectedTimeSlot:null,selectedTripPackageID:null,travelers:[],extraServices:[]}},A=(e,t)=>{const{group_pricing:a,has_group_pricing:n=!1,has_sale:r=!1,sale_price:l,price:i}=e,s=r?l:i;return n&&((e,t)=>e.find((({from:e,to:a})=>a?t>=e&&t<=a:t>=e))?.price)(a,t)||s},V=(e,t,a={},n=null,r=null)=>e?.map((e=>{var l,i,s;const{id:o,min_pax:c,pricing_type:p,label:m}=e,d=null!=n?n:c,u=t?.find((({id:e})=>e===o))||{},g=a?.travelers?.find((({id:e})=>e===o))||{},v=0!==d&&"per-group"===p.value,h=null!==(l=A(u,d))&&void 0!==l?l:A(e,d),w=o!==r?null!==(i=g?.unitPrice)&&void 0!==i?i:h:v?h/d:h,E=o!==r&&null!==(s=g?.qty)&&void 0!==s?s:d;return{id:o,qty:E,unitPrice:w,total:E>0?v?h:E*w:0,label:m,perTextLabel:` / ${p.label}`}})),G=({state:e,setState:t,updateSummary:a,handleDateChange:o,nonce:c,wpXHR:p,cartVersion:m,parentRef:d=null})=>{var u;const{summary:v,isLoading:h,tripID:E,currentTab:f,availableTimes:b,isFsd:y}=e,{travelers:T,extraServices:C,selectedTripPackageID:_,selectedTripDate:S,selectedTimeSlot:L}=v,N=B(E),P=(0,l.useSelect)((e=>e("wptravelengine").getTripServices(E)),[E]),D=(0,l.useSelect)((e=>e("wptravelengine").getTripDates(E)),[E]),I=(0,l.useSelect)((e=>e("wptravelengine").getTripPackages(E)),[E]),M=I.find((({id:e})=>e===_))?.traveler_categories||[],q=D.find((({package:{id:e}})=>e===_))?.dates[S]?.pricing||[],R=D.filter((({dates:e})=>!!e[S])).find((({package:{id:e}})=>e===_))?.dates?.[S],F=R?.times?.length>0?R?.times.find((({key:e})=>e===L))?.seats:null!==(u=R?.seats)&&void 0!==u?u:"",A=""===F||0!==F&&F>=M.reduce(((e,{min_pax:t})=>e+t),0);function G(){return(0,i.applyFilters)("wptravelengine.tripBookingModal.getTotal",e.subtotalReservations.reduce(((t,a)=>t+(Array.isArray(e.summary[a])?e.summary[a].reduce(((e,t)=>{let a=parseFloat(e)+parseFloat(t?.total||0);return t?.childrens?.length>0&&(a+=parseFloat(t.childrens.reduce(((e,t)=>e+(parseFloat(t?.total)||0)),0))),a}),0):0)),0),e)}(0,r.useEffect)((()=>{0===f&&t({processToNext:!!S&&(!b.length||L)&&_&&A})}),[_,S,b,L,f]),(0,r.useEffect)((()=>{y&&D&&I&&S&&_&&t({currentTab:b?.length>0?L?1:0:1,completedTabs:[0]})}),[_,I,D,L,b,y]),(0,r.useEffect)((()=>{if(D?.length>0&&I?.length>0){const e=P?.filter((({required:e})=>e)).flatMap((e=>e.options.map((e=>{const{key:t,price:a,label:n,serviceUnit:r}=e;return{id:t,label:n,unitPrice:a,qty:0,total:0,perTextLabel:`/ ${r.label}`,required:!0}}))))||[],t=A?V(M,q):[];a({travelers:t,extraServices:e})}}),[_,P,D,I,S]),(0,r.useEffect)((()=>{if(S){const e=D.filter((({dates:e})=>!!e[S]));let a=e.reduce(((e,{dates:t})=>[...e,...t?.[S].times||[]]),[]);a=a.map((t=>{const a=e.find((({dates:e})=>e[S].times.find((({key:e})=>e===t.key)))).package.id;return{...t,package_id:a}}));let n=[];if(a.length<1)n=e.reduce(((e,{dates:t,package:{id:a}})=>((""===t[S].seats||t[S].seats>0)&&e.push(a),e)),[]);else{const{from:t,to:a}=e.map((({dates:e})=>e[S]?.times.find((({key:e})=>e===L)))).find(Boolean)||{};n=e.reduce(((e,{dates:n,package:{id:r}})=>((n[S]?.times||[]).some((({from:e,to:n,key:r,seats:l})=>(e===t&&n===a||r===L)&&(""===l||l>0)))&&e.push(r),e)),[])}const r=_||n[0];t({summary:{...v,selectedTripPackageID:r,travelers:A?V(M,q):[]},availableTripPackages:n,availableTimes:a})}}),[S,L,D,E]);const O=(0,i.applyFilters)("wptravelengine.tripBookingModal.stepFormTabs",[{id:"date-time",title:(0,s.__)("Date & Time","wp-travel-engine"),component:(0,n.createElement)(w,{onTimeChange:function(e){const t=D.find((({dates:t})=>t[S]?.times.find((({key:t})=>t===e))))?.package?.id||D[0]?.dates[S]?.times.find((({key:t})=>t===e))?.package?.id||null;a({selectedTimeSlot:e,selectedTripPackageID:t})},onDateChange:e=>o(e,D)}),icon:(0,n.createElement)(g.Icon,{icon:"calendarCheck"}),enabled:!0},{id:"package-type",title:(0,s.__)("Package Type","wp-travel-engine"),component:(0,n.createElement)(x,{onChange:function(e){const t=D.find((({package:{id:t}})=>t===e))?.dates?.[S]?.times[0]?.key||null;a({selectedTripPackageID:e,selectedTimeSlot:t})},onTravelerChange:function(e,t){a({travelers:V(M,q,v,t,e)})}}),icon:(0,n.createElement)(g.Icon,{icon:"packageIcon"}),enabled:!0},{id:"extra-services",title:wteL10n?.l10n?.extraServicesTitle||(0,s.__)("Extra Services","wp-travel-engine"),component:(0,n.createElement)(k,null),icon:(0,n.createElement)(g.Icon,{icon:"grid"}),enabled:P.length>0}],{trip:N,state:e,setState:t,updateSummary:a});return(0,n.createElement)(Z.Provider,{value:{state:e,setState:t,getTotal:G,updateSummary:a,tripPackages:I,availableSeats:F}},(0,n.createElement)("div",{className:"wte-process-layout "+(h?"is-loading":"")},(0,n.createElement)(H,{processToNext:e.processToNext,onSubmit:async function(a){t({processToNext:!1,btnLoading:!0});const n=e.availableTimes.find((e=>e.key===L));let r=T.filter((e=>e.qty>0));r=r.length>0?r:[];let l={},s=0,o=r.reduce(((e,t)=>{const a=M.find((e=>e.id===t.id));return l[t.id]=t.qty,s+=t.qty,e[t.id]={pax:t.qty,salePrice:t.unitPrice,groupDiscountPrice:0,cost:t.unitPrice,categoryInfo:{label:a.label,price:a.price,enabledSale:a.has_sale,salePrice:a.sale_price,minPax:a.min_pax,maxPax:a.max_pax,groupPricing:a.group_pricing,enabledGroupDiscount:a.has_group_pricing,pricingType:a.pricing_type.value}},e}),{}),d=(0,i.applyFilters)("wptravelengine.tripBookingModal.cart.subtotalReservations",e.subtotalReservations.reduce(((e,t)=>(e[t]=v[t].map((e=>e.id&&""!==e.unitPrice&&0!==e.qty?{id:e.id,quantity:e.qty}:null)).filter(Boolean),e)),{}),e),u={cartTotal:G(),nonce:c,packageID:_,pricingOptions:o,timeRange:n&&[n.from,n.to],traveler:s,tripDate:S,travelers:l,tripID:E,tripTime:n&&n.from,cartVersion:m,subtotalReservations:d};if(C.length>0){const e=C.filter((e=>0!==e.qty));u={...u,extraServices:e.map((e=>({extra_service:e.label,price:e.unitPrice,qty:e.qty})))}}const g=await fetch(`${p}?action=wte_add_trip_to_cart&cart_version=${u.cartVersion}&_nonce=${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!g.ok)throw new Error(g.statusText);try{const e=await g.json();if(e.success)return window.location.href=e.data.redirect,e;if(e.data&&e.data[0])throw new Error(e.data[0])}catch(a){throw Error(a.message)}},tabs:O}),(0,n.createElement)($,null)))},O=e=>{const[t,a]=(0,r.useState)({...F}),l=e=>a((t=>({...t,...e}))),{isOpen:i}=t;function c(e){a((t=>({...t,summary:{...t.summary,...e}})))}function p(e,t){const a=t.find((({dates:t})=>t[e]))?.package?.id||t[0]?.package?.id||null;c({selectedTripDate:e,selectedTimeSlot:null,selectedTripPackageID:a})}return(0,r.useEffect)((()=>{document.dispatchEvent(new Event("bookingCalendarReady")),window.addEventListener("pageshow",(e=>{e.persisted&&l({isLoading:!1,processToNext:!0,btnLoading:!1})}))}),[]),(0,r.useEffect)((()=>{window.wptravelengineBooking=window.wptravelengineBooking||{},window.wptravelengineBooking.store={state:t,setState:e=>{a((t=>({...t,...e})))},setTripDate:p,setSummary:c}}),[]),(0,n.createElement)(o,{isOpen:i,setIsOpen:()=>{l({isOpen:!t.isOpen})}},(0,n.createElement)("p",{style:{display:"none"}},(0,s.__)("WP Travel Engine Booking Initialized.","wp-travel-engine")),(0,n.createElement)(G,{state:t,setState:l,updateSummary:c,handleDateChange:p,...e}))};var W=a(6109),j=a.n(W);window.wptravelengineBooking=window.wptravelengineBooking||{},window.wptravelengineBooking.app=O;const Z=(0,r.createContext)();function Y(){return(0,r.useContext)(Z)}j()((()=>{var e,t;let a=null!==(e=document.querySelector("#wptravelengine-trip-booking-modal"))&&void 0!==e?e:null;a||(a=document.createElement("div"),a.style.display="none",a.style.height=0,a.id="wptravelengine-trip-booking-modal",document.body.appendChild(a)),(0,i.applyFilters)("wptravelengine.tripBookingModal.open",!0,{appContainer:a})&&(a._reactRoot||(a._reactRoot=(0,r.createRoot)(a)),a._reactRoot.render((0,n.createElement)(r.StrictMode,null,(0,n.createElement)(O,{parentRef:a,...JSON.parse(null!==(t=a.dataset.tripBooking)&&void 0!==t?t:"{}")}))),document.querySelectorAll("[data-trip-booking],#open-booking-modal,.wte-fsd-list-booknow-btn")?.forEach((e=>{var t;const a=JSON.parse(null!==(t=e.dataset.tripBooking)&&void 0!==t?t:"{}");if(a.isOpen=!0,"button"===e.tagName.toLowerCase()&&(e.disabled=!1),e.classList.contains("wte-fsd-list-booknow-btn")&&(e.disabled=!1,e.classList.remove("btn-loading"),!a.tripID&&document.body.classList.contains("single-trip"))){a.tripID=document.body.className.match(/postid-(\d+)/)?.[1];const t=e.dataset.info;t&&(a.summary={selectedTripDate:moment(1e3*+t).format("YYYY-MM-DD")})}e.addEventListener("click",(()=>{var e,t;const{state:n,setState:r}=window.wptravelengineBooking.store;setTimeout((()=>{r({isOpen:!0,isFsd:a.isFsd})})),r({summary:{...n.summary,selectedTripDate:null!==(e=a.summary?.selectedTripDate)&&void 0!==e?e:null},tripID:null!==(t=a?.tripID)&&void 0!==t?t:null,currentTab:0,isLoading:!0})}))})))}))}}]);